import{r as U,a as p}from"./index._OACqPSs.js";var E={exports:{}},v={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T;function q(){if(T)return v;T=1;var t=U(),r=Symbol.for("react.element"),n=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function d(i,s,x){var l,m={},g=null,h=null;x!==void 0&&(g=""+x),s.key!==void 0&&(g=""+s.key),s.ref!==void 0&&(h=s.ref);for(l in s)o.call(s,l)&&!c.hasOwnProperty(l)&&(m[l]=s[l]);if(i&&i.defaultProps)for(l in s=i.defaultProps,s)m[l]===void 0&&(m[l]=s[l]);return{$$typeof:r,type:i,key:g,ref:h,props:m,_owner:a.current}}return v.Fragment=n,v.jsx=d,v.jsxs=d,v}var _;function W(){return _||(_=1,E.exports=q()),E.exports}var e=W();const A="https://cors.forth.ink/message/index.html",S={chrome:"knhlkjdfmgkmelcjfnbbhpphkmjjacng",firefox:"my-firefox-extension-id"},F=navigator.userAgent.includes("firefox"),M=F?S.firefox:S.chrome;class P extends Error{type;constructor(r){super(r.message),this.type=r.type,this.name="AppCorsError"}}let C=null,R=null;function N(){return C||(C=new Promise((t,r)=>{const n=document.createElement("iframe");n.src=`${A}?origin=${encodeURIComponent(location.origin)}&extID=${encodeURIComponent(M)}`;const o=a=>{a.source===n.contentWindow&&(R=n.contentWindow,window.removeEventListener("message",o),t(n))};window.addEventListener("message",o),n.onerror=r,n.style.display="none",document.body.appendChild(n)}),C)}const b=new Set,D={addListener(t){b.size||N().then(()=>I(!0)).catch(console.error),b.add(t)},removeListener(t){t?b.delete(t):b.clear(),b.size===0&&N().then(()=>I(!1)).catch(console.error)}};function I(t){return y({method:"toggleChangeListener",payload:{enabled:t}})}let L=!1;const k={};function $(){L||(L=!0,window.addEventListener("message",t=>{const r=t.data;if(t.source!==R)return;if(console.log("npm message event",r),r.type==="onChange"){b.forEach(c=>{c(r.data)});return}const n=k[r.id];if(!n)return;delete k[r.id];const[o,a]=n;r.error?a(new P(r.error)):o(r.data)}))}async function y(t){return await N(),new Promise((r,n)=>{R||n(new Error("frameWin is not ready"));const o=Math.random().toString(36).slice(2),a={id:o,...t,type:"ext"};$(),k[o]=[r,n],R.postMessage(a,"*")})}function J(){return y({method:"isInstalled"})}function X(){return y({method:"openOptions"})}function z(){const t=F?"https://addons.mozilla.org/en-US/firefox/addon/cors-unlocker/":`https://chromewebstore.google.com/detail/${M}`;window.open(t,"_blank")}async function G(){try{return await y({method:"isEnabled"})}catch(t){if(t instanceof P&&t.type==="not-installed")return!1;throw t}}function V(t){return y({method:"enable",payload:t})}function Y(){return y({method:"disable"})}const f={isExtInstalled:J,openExtOptions:X,openStorePage:z,isEnabled:G,onChange:D,enable:V,disable:Y};globalThis.appCors=f;console.log('%cuse `appCors` in console to test the API of "cors-unlocker"',"color: #0a0; font-size: 1.5em");function B(){const[t,r]=p.useState(!1),[n,o]=p.useState("idle"),[a,c]=p.useState(!1),[d,i]=p.useState({enabled:!1,credentials:!1}),[s,x]=p.useState({method:"GET",url:"",curlCommand:""}),l=p.useRef({contentType:"",mediaType:"",content:""}),m=p.useRef(null);return p.useEffect(()=>(f.isEnabled().then(u=>{i(u||{enabled:!1,credentials:!1})}),f.isExtInstalled().then(c),f.onChange.addListener(i),()=>{f.onChange.removeListener(i)}),[]),{isCurlMode:t,isInstalled:a,setIsCurlMode:r,status:n,requestForm:s,setRequestForm:x,doRequest:async()=>{if(n!=="loading")try{o("loading");let u;t?u=O(...K(s.curlCommand)):u=O(s.url,{method:s.method});const w=await u.next();if(w.done)return;l.current=w.value,o("partial");const j=await u.next();l.current.content=typeof j.value=="string"?j.value:URL.createObjectURL(j.value),o("success")}catch(u){m.current=u,o("error")}},setFormValue:(u,w)=>{x(j=>({...j,[u]:w}))},responseRef:l,errorRef:m,corsStatus:d,toggleCors:async()=>{a&&(d.enabled?await f.disable():await f.enable({reason:"Enable for demonstration"}))},toggleCorsCredentials:async()=>{d.enabled&&(d.credentials?await f.enable({credentials:!1}):await f.enable({credentials:!0,reason:"Enable for demonstration"}))}}}async function*O(t,r){const n=await fetch(t,r),o=n.headers.get("content-type")||"",a=H(o);switch(yield{contentType:o,mediaType:a},a){case"text":yield await n.text();break;default:yield await n.blob();break}return!0}function H(t){if(!t)return"unknown";const r=t.toLowerCase();return r.startsWith("text/")||r.includes("json")||r.includes("javascript")||r.includes("xml")||r.includes("csv")?"text":r.startsWith("image/")?"image":r.startsWith("audio/")?"audio":r.startsWith("video/")?"video":"binary"}function K(t){const r=t.match(/curl\s+['"]?(https?:\/\/[^\s'"\\]+)['"]?/),n=t.match(/-X\s+(\w+)/i),o=[...t.matchAll(/-H\s+['"]?([^'"\n]+)['"]?/g)],a=t.match(/--data(?:-raw)?\s+['"]?([^'"\n]+)['"]?/),c={};return o.forEach(d=>{const[i,s]=d[1].split(/:\s*/);i&&s&&(c[i.trim()]=s.trim())}),[r?r[1]:"",{method:n?n[1].toUpperCase():"GET",headers:c,body:a?a[1]:null}]}const re=()=>{const{status:t,setFormValue:r,requestForm:n,errorRef:o,corsStatus:a,isCurlMode:c,setIsCurlMode:d,doRequest:i,responseRef:s,toggleCors:x,toggleCorsCredentials:l,isInstalled:m}=B(),g=()=>t==="idle"?e.jsx("p",{children:"No request yet."}):t==="loading"?e.jsx("p",{children:"Loading..."}):t==="error"?e.jsxs("p",{children:["Error occurred while fetching response: ",o.current?.message]}):t==="partial"?e.jsxs("p",{children:["Response is being fetched, ",s.current.mediaType,"(",s.current.contentType,") received, body is been handling..."]}):e.jsx(Q,{...s.current});return e.jsxs("div",{className:"p-4 max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Cross-Origin Request Playground"}),e.jsxs("div",{className:"mb-6 border-b pb-4 relative border-gray-200",children:[e.jsxs("label",{className:"text-lg font-medium absolute top-0 right-0",children:["cURL",e.jsx("input",{type:"checkbox",checked:c,onChange:()=>d(!c),className:"w-4 h-4 cursor-pointer"})]}),c?e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2",children:"cURL Command:"}),e.jsx("textarea",{autoFocus:!0,placeholder:"Enter a valid cURL command",value:n.curlCommand,onChange:h=>r("curlCommand",h.target.value),className:"border border-gray-200 rounded p-2 w-full h-32"})]}):e.jsxs("div",{className:"flex gap-4 items-center justify-center",children:[e.jsxs("div",{className:"w-32",children:[e.jsx("label",{className:"block mb-2",children:"Method:"}),e.jsxs("select",{value:n.method,onChange:h=>r("method",h.target.value),className:"border border-gray-200 rounded p-2 h-10 w-full",children:[e.jsx("option",{value:"GET",children:"GET"}),e.jsx("option",{value:"POST",children:"POST"}),e.jsx("option",{value:"PUT",children:"PUT"}),e.jsx("option",{value:"DELETE",children:"DELETE"})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block mb-2",children:"URL:"}),e.jsx("input",{type:"url",autoFocus:!0,placeholder:"Enter a valid URL",value:n.url,onChange:h=>r("url",h.target.value),className:"border border-gray-200 rounded p-2 h-10 w-full"})]})]}),e.jsxs("div",{className:"mt-4 flex items-center",children:[e.jsx("button",{disabled:t==="loading",onClick:i,className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded hover:bg-blue-700 disabled:opacity-50",children:"Send Request"}),m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"ml-4 text-sm",children:"CORS Manage"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("input",{type:"checkbox",id:"toggle-cors",readOnly:!0,hidden:!0,className:"peer",checked:a.enabled}),e.jsx("label",{htmlFor:"toggle-cors",className:"px-2 py-1 transition-all bg-gray-200 text-gray-800 rounded hover:bg-gray-300 bg-gradient-to-r opacity-80  peer-checked:from-cyan-500 peer-checked:to-blue-500 peer-checked:text-white",onClick:x,children:"CORS"})]}),e.jsxs("div",{className:"ml-4",children:[e.jsx("input",{type:"checkbox",id:"toggle-credentials",readOnly:!0,hidden:!0,className:"peer",checked:a.credentials}),e.jsx("label",{htmlFor:"toggle-credentials","aria-disabled":!a.enabled,className:"px-2 py-1 transition-all bg-gray-200 text-gray-800 rounded hover:bg-gray-300 bg-gradient-to-r opacity-80 aria-disabled:opacity-50  peer-checked:from-cyan-500 peer-checked:to-blue-500 peer-checked:text-white",onClick:l,children:"with credentials"})]})]}):e.jsxs("div",{className:"ml-2 text-sm text-red-500",children:["You need to ",e.jsx("a",{href:"/",className:"text-blue-400",children:"install the extension"})," to manage CORS"]})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Response"}),e.jsx("div",{className:"border border-gray-200 p-4 rounded bg-gray-50",children:g()})]})]})};function Q(t){const r=e.jsxs("div",{className:"mb-2 text-gray-400",children:["Response Type: ",t.mediaType,"(",t.contentType,")"]});switch(t.mediaType){case"text":return e.jsxs(e.Fragment,{children:[r,e.jsx("pre",{className:"whitespace-pre-line break-words",children:t.content})]});case"audio":return e.jsxs(e.Fragment,{children:[r,e.jsx("audio",{controls:!0,src:t.content,className:"block max-w-full"}),";"]});case"video":return e.jsxs(e.Fragment,{children:[r,e.jsx("video",{controls:!0,src:t.content,className:"block max-w-full"}),";"]});case"image":return e.jsxs(e.Fragment,{children:[r,e.jsx("img",{src:t.content,alt:"Response",className:"block max-w-full h-auto"}),";"]});default:return e.jsxs("div",{children:[e.jsxs("p",{children:["Unsupported response type: ",t.contentType]}),e.jsx("a",{href:t.content,download:"response",className:"text-blue-500 hover:underline",children:"Download Content"})]})}}export{re as PlaygroundPage};
