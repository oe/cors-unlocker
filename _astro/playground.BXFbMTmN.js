import{r as U,a as x}from"./index.CcfSqGrV.js";var E={exports:{}},v={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T;function q(){if(T)return v;T=1;var e=U(),n=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function d(i,a,p){var c,f={},m=null,R=null;p!==void 0&&(m=""+p),a.key!==void 0&&(m=""+a.key),a.ref!==void 0&&(R=a.ref);for(c in a)o.call(a,c)&&!l.hasOwnProperty(c)&&(f[c]=a[c]);if(i&&i.defaultProps)for(c in a=i.defaultProps,a)f[c]===void 0&&(f[c]=a[c]);return{$$typeof:n,type:i,key:m,ref:R,props:f,_owner:s.current}}return v.Fragment=r,v.jsx=d,v.jsxs=d,v}var _;function W(){return _||(_=1,E.exports=q()),E.exports}var t=W();const A="https://cors.forth.ink/message/index.html",S={chrome:"knhlkjdfmgkmelcjfnbbhpphkmjjacng",firefox:"my-firefox-extension-id"},I=navigator.userAgent.includes("firefox"),M=I?S.firefox:S.chrome;class P extends Error{type;constructor(n){super(n.message),this.type=n.type,this.name="AppCorsError"}}let w=null,C=null;function N(){return w||(w=new Promise((e,n)=>{const r=document.createElement("iframe");r.src=`${A}?origin=${encodeURIComponent(location.origin)}&extID=${encodeURIComponent(M)}`;const o=s=>{s.source===r.contentWindow&&(C=r.contentWindow,window.removeEventListener("message",o),e(r))};window.addEventListener("message",o),r.onerror=n,r.style.display="none",document.body.appendChild(r)}),w)}const g=new Set,D={addListener(e){g.size||N().then(()=>L(!0)).catch(console.error),g.add(e)},removeListener(e){e?g.delete(e):g.clear(),g.size===0&&N().then(()=>L(!1)).catch(console.error)}};function L(e){return b({method:"toggleChangeListener",payload:{enabled:e}})}let O=!1;const k={};function $(){O||(O=!0,window.addEventListener("message",e=>{const n=e.data;if(e.source!==C)return;if(console.log("npm message event",n),n.type==="onChange"){g.forEach(l=>{l(n.data)});return}const r=k[n.id];if(!r)return;delete k[n.id];const[o,s]=r;n.error?s(new P(n.error)):o(n.data)}))}async function b(e){return await N(),new Promise((n,r)=>{C||r(new Error("frameWin is not ready"));const o=Math.random().toString(36).slice(2),s={id:o,...e,type:"ext"};$(),k[o]=[n,r],C.postMessage(s,"*")})}function J(){return b({method:"isInstalled"})}function X(){return b({method:"openOptions"})}function z(){const e=I?"https://addons.mozilla.org/en-US/firefox/addon/browser-app-cors/":`https://chromewebstore.google.com/detail/${M}`;window.open(e,"_blank")}async function G(){try{return await b({method:"isEnabled"})}catch(e){if(e instanceof P&&e.type==="not-installed")return!1;throw e}}function V(e){return b({method:"enable",payload:e})}function B(){return b({method:"disable"})}const h={isExtInstalled:J,openExtOptions:X,openStorePage:z,isEnabled:G,onChange:D,enable:V,disable:B};globalThis.appCors=h;console.log('%cuse `appCors` in console to test the API of "browser-app-cors"',"color: #0a0; font-size: 1.5em");function H(){const[e,n]=x.useState(!1),[r,o]=x.useState("idle"),[s,l]=x.useState({enabled:!1,credentials:!1}),[d,i]=x.useState({method:"GET",url:"",curlCommand:""}),a=x.useRef({contentType:"",mediaType:"",content:""}),p=x.useRef(null);return x.useEffect(()=>(h.isEnabled().then(u=>{l(u||{enabled:!1,credentials:!1})}),h.onChange.addListener(l),()=>{h.onChange.removeListener(l)}),[]),{isCurlMode:e,setIsCurlMode:n,status:r,requestForm:d,setRequestForm:i,doRequest:async()=>{if(r!=="loading")try{o("loading");let u;e?u=F(...K(d.curlCommand)):u=F(d.url,{method:d.method});const j=await u.next();if(j.done)return;a.current=j.value,o("partial");const y=await u.next();a.current.content=typeof y.value=="string"?y.value:URL.createObjectURL(y.value),o("success")}catch(u){p.current=u,o("error")}},setFormValue:(u,j)=>{i(y=>({...y,[u]:j}))},responseRef:a,errorRef:p,corsStatus:s,toggleCors:async()=>{s.enabled?await h.disable():await h.enable({reason:"Enable for demonstration"})},toggleCorsCredentials:async()=>{s.enabled&&(s.credentials?await h.enable({credentials:!1}):await h.enable({credentials:!0,reason:"Enable for demonstration"}))}}}async function*F(e,n){const r=await fetch(e,n),o=r.headers.get("content-type")||"",s=Y(o);switch(yield{contentType:o,mediaType:s},s){case"text":yield await r.text();break;default:yield await r.blob();break}return!0}function Y(e){if(!e)return"unknown";const n=e.toLowerCase();return n.startsWith("text/")||n.includes("json")||n.includes("javascript")||n.includes("xml")||n.includes("csv")?"text":n.startsWith("image/")?"image":n.startsWith("audio/")?"audio":n.startsWith("video/")?"video":"binary"}function K(e){const n=e.match(/curl\s+['"]?(https?:\/\/[^\s'"\\]+)['"]?/),r=e.match(/-X\s+(\w+)/i),o=[...e.matchAll(/-H\s+['"]?([^'"\n]+)['"]?/g)],s=e.match(/--data(?:-raw)?\s+['"]?([^'"\n]+)['"]?/),l={};return o.forEach(d=>{const[i,a]=d[1].split(/:\s*/);i&&a&&(l[i.trim()]=a.trim())}),[n?n[1]:"",{method:r?r[1].toUpperCase():"GET",headers:l,body:s?s[1]:null}]}const ee=()=>{const{status:e,setFormValue:n,requestForm:r,errorRef:o,corsStatus:s,isCurlMode:l,setIsCurlMode:d,doRequest:i,responseRef:a,toggleCors:p,toggleCorsCredentials:c}=H(),f=()=>e==="idle"?t.jsx("p",{children:"No request yet."}):e==="loading"?t.jsx("p",{children:"Loading..."}):e==="error"?t.jsxs("p",{children:["Error occurred while fetching response: ",o.current?.message]}):e==="partial"?t.jsxs("p",{children:["Response is being fetched, ",a.current.mediaType,"(",a.current.contentType,") received, body is been handling..."]}):t.jsx(Q,{...a.current});return t.jsxs("div",{className:"p-4 max-w-4xl mx-auto",children:[t.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Cross-Origin Request Playground"}),t.jsxs("div",{className:"mb-6 border-b pb-4 relative",children:[t.jsxs("label",{className:"text-lg font-medium absolute top-0 right-0",children:["cURL",t.jsx("input",{type:"checkbox",checked:l,onChange:()=>d(!l),className:"w-4 h-4 cursor-pointer"})]}),l?t.jsxs("div",{children:[t.jsx("label",{className:"block mb-2",children:"cURL Command:"}),t.jsx("textarea",{autoFocus:!0,placeholder:"Enter a valid cURL command",value:r.curlCommand,onChange:m=>n("curlCommand",m.target.value),className:"border rounded p-2 w-full h-32"})]}):t.jsxs("div",{className:"flex gap-4 items-center justify-center",children:[t.jsxs("div",{className:"w-32",children:[t.jsx("label",{className:"block mb-2",children:"Method:"}),t.jsxs("select",{value:r.method,onChange:m=>n("method",m.target.value),className:"border rounded p-2 h-10 w-full",children:[t.jsx("option",{value:"GET",children:"GET"}),t.jsx("option",{value:"POST",children:"POST"}),t.jsx("option",{value:"PUT",children:"PUT"}),t.jsx("option",{value:"DELETE",children:"DELETE"})]})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block mb-2",children:"URL:"}),t.jsx("input",{type:"url",autoFocus:!0,placeholder:"Enter a valid URL",value:r.url,onChange:m=>n("url",m.target.value),className:"border rounded p-2 h-10 w-full"})]})]}),t.jsxs("div",{className:"mt-4 flex items-center",children:[t.jsx("button",{disabled:e==="loading",onClick:i,className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded hover:bg-blue-700 disabled:opacity-50",children:"Send Request"}),t.jsx("div",{className:"ml-4 text-sm",children:"CORS Manage"}),t.jsxs("div",{className:"ml-4",children:[t.jsx("input",{type:"checkbox",id:"toggle-cors",readOnly:!0,hidden:!0,className:"peer",checked:s.enabled}),t.jsx("label",{htmlFor:"toggle-cors",className:"px-2 py-1 transition-all bg-gray-200 text-gray-800 rounded hover:bg-gray-300 bg-gradient-to-r opacity-80 peer-checked:from-cyan-500 peer-checked:to-blue-500 peer-checked:text-white",onClick:p,children:"CORS"})]}),t.jsxs("div",{className:"ml-4",children:[t.jsx("input",{type:"checkbox",id:"toggle-credentials",readOnly:!0,hidden:!0,className:"peer",checked:s.credentials}),t.jsx("label",{htmlFor:"toggle-credentials","aria-disabled":!s.enabled,className:"px-2 py-1 transition-all bg-gray-200 text-gray-800 rounded hover:bg-gray-300 bg-gradient-to-r opacity-80 aria-disabled:opacity-50  peer-checked:from-cyan-500 peer-checked:to-blue-500 peer-checked:text-white",onClick:c,children:"with credentials"})]})]})]}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Response"}),t.jsx("div",{className:"border p-4 rounded bg-gray-50",children:f()})]})]})};function Q(e){const n=t.jsxs("div",{className:"mb-2",children:["Response Type: ",e.mediaType,"(",e.contentType,")"]});switch(e.mediaType){case"text":return t.jsxs(t.Fragment,{children:[n,t.jsx("pre",{className:"whitespace-pre-line",children:e.content})]});case"audio":return t.jsxs(t.Fragment,{children:[n,t.jsx("audio",{controls:!0,src:e.content,className:"block max-w-full"}),";"]});case"video":return t.jsxs(t.Fragment,{children:[n,t.jsx("video",{controls:!0,src:e.content,className:"block max-w-full"}),";"]});case"image":return t.jsxs(t.Fragment,{children:[n,t.jsx("img",{src:e.content,alt:"Response",className:"block max-w-full h-auto"}),";"]});default:return t.jsxs("div",{children:[t.jsxs("p",{children:["Unsupported response type: ",e.contentType]}),t.jsx("a",{href:e.content,download:"response",className:"text-blue-500 hover:underline",children:"Download Content"})]})}}export{ee as PlaygroundPage};
