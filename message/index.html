<!DOCTYPE html><html> <head><meta name="robots" content="noindex"><title>Extension Messaging frame</title><script type="module">const a=typeof chrome<"u"?chrome:typeof browser<"u"?browser:null;parent===window?document.body.innerHTML="<p>This page is intended to be embedded for internal communication.</p>":parent.postMessage({type:"ext",method:"init"},"*");const i=(()=>{const e=new URLSearchParams(location.search);return{extID:e.get("extID"),origin:e.get("origin")}})();let o=null;const m=()=>{if(!(!i.extID||o))try{o=a.runtime.connect(i.extID),o.onDisconnect.addListener(()=>{o=null})}catch{o=null}},g=async()=>(o||m(),o),l={isInstalled:async e=>{if(!(!!a&&!!a.runtime)){if(e?.throw)throw{type:"not-installed",message:"browser extension API not available"};return!1}if(!i.extID){if(e?.throw)throw{type:"config-error",message:"extID not provided"};return!1}try{return await new Promise((s,r)=>{a.runtime.sendMessage(i.extID,{method:"ping",payload:{}},n=>{if(a.runtime.lastError){r(new Error(a.runtime.lastError.message||"Extension communication failed"));return}s()}),setTimeout(()=>{r(new Error("Extension communication timeout"))},2e3)}),!0}catch{if(e?.throw)throw{type:"not-installed",message:`extension with ID ${i.extID} not installed or not responding`};return!1}},enable:async e=>{const t=await c("getRule");if(t&&!t.disabled){if(!e||typeof e.credentials>"u")return{enable:!0,credentials:t.credentials};if(t.credentials===e.credentials)return{enabled:!0,credentials:t.credentials}}const s=i.origin;if(!t||t.disabled||!t.credentials){let r=`Current page("${s}") is requesting to enable CORS`;if(r+=e?.credentials?" **with credentials**.":".",r+=e?.reason?`

Message from current Page:
${e.reason}

`:`

`,r+="Please only enable CORS with credentials if you trust the current page. Do you want to continue?",!confirm(r))throw{type:"user-cancel",message:"User canceled"}}return c("enable",e)}};window.addEventListener("message",async e=>{const t=e.data;if(!f(t)||t.type!=="ext")return;const{method:s,payload:r}=t;try{const n=l[s];if(s!=="isInstalled"&&await l.isInstalled({throw:!0}),!i.extID||!i.origin)throw{type:"config-error",message:"extID or origin not provided"};try{new URL(i.origin)}catch{throw{type:"invalid-origin",message:"invalid origin"}}const u=n?await n(r):await c(s,r);d({id:t.id,type:"response",data:u})}catch(n){d({id:t.id,type:"response",error:n&&typeof n=="object"?n:{message:n,type:"inner-error"}})}});function c(e,t){return new Promise((s,r)=>{g(),a.runtime.sendMessage(i.extID,{method:e,payload:{...t,origin:i.origin}},n=>{if(n&&typeof n=="object"&&n.__mozWebExtensionPolyfillReject__)try{return r(JSON.parse(n.message))}catch{return r(n.message)}if(a.runtime.lastError)return o=null,r({type:"communication-failed",message:a.runtime.lastError.message||"Connection failed"});s(n)})})}function f(e){return e&&e.type&&e.id&&e.method}function d(e){parent.postMessage(e,"*")}</script></head> </html>